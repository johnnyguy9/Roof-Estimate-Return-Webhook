<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Instant Roof Estimate</title>

  <!-- Google Places API -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCm6Cw8lXx4as9YB57j-XmqYLGfSPEUW9Q&libraries=places"></script>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #0A0E14;
      color: #fff;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .estimate-container {
      width: 100%;
      max-width: 540px;
      background: #0F1520;
      border-radius: 16px;
      padding: 40px;
      border: 1px solid #2D3A4D;
    }

    h1 {
      text-align: center;
      margin-bottom: 8px;
    }

    p.sub {
      text-align: center;
      color: #9FBDC9;
      margin-bottom: 32px;
    }

    .question { margin-bottom: 24px; }
    .hidden { display: none; }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }

    input {
      width: 100%;
      padding: 14px;
      border-radius: 8px;
      border: 1px solid #2D3A4D;
      background: #0A0E14;
      color: #fff;
      font-size: 15px;
    }

    .button-group {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    button.option {
      padding: 14px;
      border-radius: 8px;
      border: 2px solid #2D3A4D;
      background: #0A0E14;
      color: #fff;
      cursor: pointer;
    }

    button.option.selected {
      background: #00BFFF;
      border-color: #00BFFF;
    }

    button.submit {
      width: 100%;
      padding: 16px;
      border-radius: 8px;
      border: none;
      background: #00BFFF;
      color: #fff;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 24px;
    }

    .loading,
    .result {
      text-align: center;
    }
  </style>
</head>

<body>
  <div class="estimate-container">
    <h1>Instant Roof Estimate</h1>
    <p class="sub">Answer a few quick questions</p>

    <form id="estimateForm">
      <div class="question">
        <label>First Name</label>
        <input id="firstName" required />
      </div>

      <div class="question hidden">
        <label>Email</label>
        <input id="email" type="email" required />
      </div>

      <div class="question hidden">
        <label>Property Address</label>
        <input id="address" placeholder="Start typing address…" required />
      </div>

      <div class="question hidden">
        <label>Roof Type</label>
        <div class="button-group">
          <button type="button" class="option" data-roof="Asphalt">Asphalt</button>
          <button type="button" class="option" data-roof="Metal">Metal</button>
          <button type="button" class="option" data-roof="Tile">Tile</button>
          <button type="button" class="option" data-roof="Other">Other</button>
        </div>
      </div>

      <div class="question hidden">
        <label>Stories</label>
        <div class="button-group">
          <button type="button" class="option" data-stories="1">1 Story</button>
          <button type="button" class="option" data-stories="2">2 Stories</button>
          <button type="button" class="option" data-stories="3">3+ Stories</button>
        </div>
      </div>

      <button class="submit hidden" type="submit">Get My Estimate</button>
    </form>

    <div class="loading hidden">Calculating estimate…</div>
    <div class="result hidden"></div>
  </div>

  <script>
    const webhook =
      "https://services.leadconnectorhq.com/hooks/FDGIykNfntzs46TT1VA7/webhook-trigger/EO7CUMjucJlR9uy7SuDa";

    const form = document.getElementById("estimateForm");
    const steps = document.querySelectorAll(".question");
    const submitBtn = document.querySelector(".submit");
    const loading = document.querySelector(".loading");
    const result = document.querySelector(".result");

    let step = 0;
    let data = {};

    function next() {
      steps[step].classList.add("hidden");
      step++;
      if (steps[step]) steps[step].classList.remove("hidden");
      if (step === steps.length - 1) submitBtn.classList.remove("hidden");
    }

    steps[0].querySelector("input").addEventListener("blur", e => {
      data.firstName = e.target.value;
      if (data.firstName) next();
    });

    steps[1].querySelector("input").addEventListener("blur", e => {
      data.email = e.target.value;
      if (data.email) next();
    });

    const addressInput = document.getElementById("address");
    const autocomplete = new google.maps.places.Autocomplete(addressInput, {
      types: ["address"],
      componentRestrictions: { country: "us" }
    });

    autocomplete.addListener("place_changed", () => {
      data.address = autocomplete.getPlace().formatted_address;
      next();
    });

    document.querySelectorAll("[data-roof]").forEach(btn => {
      btn.onclick = () => {
        data.roof_type = btn.dataset.roof;
        next();
      };
    });

    document.querySelectorAll("[data-stories]").forEach(btn => {
      btn.onclick = () => {
        data.stories = btn.dataset.stories;
      };
    });

    form.onsubmit = async e => {
      e.preventDefault();
      form.classList.add("hidden");
      loading.classList.remove("hidden");

      await fetch(webhook, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          firstName: data.firstName,
          email: data.email,
          address: data.address,
          roof_type: data.roof_type,
          stories: data.stories
        })
      });

      loading.innerHTML = "Estimate sent. Check your screen…";
    };
  </script>
</body>
</html>
